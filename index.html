<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta property="og:image" content="http://Save4TheFutureNow.com/water-assets/logo.png">
    <meta property="og:site_name" content="Save4TheFuture" />
    <meta property="og:title" content="Save4TheFuture" />
    <meta property="og:url" content="http://Save4TheFutureNow.com/">
    <meta name="description" content="Save4TheFuture is an initiative to start saving water.">
    <meta name="keywords" content="PUB, water, saving, conservation, future, saving water, NYP, nanyang polytechnic">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="water-assets/fullpage.min.css" />
    <link rel="stylesheet" href="water-assets/loaders.min.css" />
    <link rel="icon" type="image/png" href="water-assets/logo.png" />

    <style>
        @media (max-width: 1024px) {
            #pledges-list>div:nth-child(n + 7) {
                display: none;
            }

            @media (max-width: 768px) {
                #pledges-list>div:nth-child(n + 6) {
                    display: none;
                }
            }
        }
    </style>
    <title>#Save4TheFutureNow</title>
</head>


<body>
    <div id="fullpage">
        <div class="section">
            <div id="introduction" class="row no-gutters justify-content-center">
                <div id="intro-gif" class="col-md-5">
                    <div class="table-display">
                        <div class="table-child">
                            <img src="water-assets/fishingman.gif" class="w-100">
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-12">
                    <div class="table-display">
                        <div class="table-child">
                            <div class="p-3">
                                <div id="counter-container"
                                    class="d-flex justify-content-lg-start justify-content-md-center">
                                    <h1 id="counter"></h1>
                                    <p class="counter-subtitle" style="line-height: 61px;">pledges</p>
                                </div>
                                <div class="mt-1">
                                    <p class="tagline font-weight-bold" style="font-size: 1rem;">
                                        Waste Water Today, Live In Desert Tomorrow
                                    </p>
                                    <p class="counter-subtitle mt-5">I will pledge too!</p>

                                    <div class="input-group mb-3">
                                        <input id="pledgerName" type="text" class="form-control"
                                            placeholder="Enter your name or leave blank for 'Anonymous'"
                                            aria-label="Recipient's username" aria-describedby="button-addon2" required>
                                        <button class="btn btn-dark" type="button"
                                            onclick="incrementPledges()">Pledge!</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="container p-3">
                <div class="row justify-content-center">
                    <h1 id="pledge-title">Recent Pledges</h1>
                </div>
                <div id="landing-loading" class="loader text-center">
                    <div class="ball-pulse">
                        <div></div>
                        <div></div>
                        <div></div>
                    </div>
                </div>
                <div id="pledges-list" class="row no-gutters justify-content-center">
                </div>
                <div class="text-center text-dark my-4"><a href="/pledges.html">Click here to view all
                        pledges</a></div>
            </div>
        </div>

        <div class="section">
            <div class="row no-gutters justify-content-center bg-blue">
                <div class="col-lg-5 col-md-12">
                    <div class="table-display w-100">
                        <div class="table-child text-center">
                            <h1 class="mt-3" id="connect-with-us">Connect with us!</h1>
                            <div style="margin-bottom:5%;">
                                <a href="https://www.instagram.com/save4thefuturenow/" target="_blank"
                                    class="text-white a-link ">Instagram</a>
                                · <a href="https://www.facebook.com/save4thefuture/" target="_blank"
                                    class="text-white a-link ">Facebook</a>
                                · <a href="https://www.youtube.com/channel/UCgkcODnS8M2X74vnUl3E1fQ" target="_blank"
                                    class="text-white a-link ">YouTube</a>
                            </div>

                            <div class="row no-gutters justify-content-md-center mt-3 p-3">
                                <!-- <div id="instagram-container" class="col-md-5 mb-4">
                                    <script src="https://apps.elfsight.com/p/platform.js" defer></script>
                                    <div style="width: 340px" class="elfsight-app-88510386-0611-4bf9-8d7c-6ebbaa1abf06">
                                    </div>
                                </div> -->

                                <div class="col-md-12">
                                    <iframe
                                        src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2Fsave4thefuture&tabs=timeline&width=340&height=500&small_header=false&adapt_container_width=true&hide_cover=false&show_facepile=true&appId=909302709403209"
                                        width="340" height="500" style="border:none;overflow:hidden" scrolling="no"
                                        frameborder="0" allowTransparency="true" allow="encrypted-media"></iframe>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="row no-gutters justify-content-center">
                <div class="col-lg-5 col-md-8 col-sm-10 text-center p-3">
                    <h1>About Us</h1>
                    <p class="mt-3">
                        We are a group of students from NYP and trying to spread awareness
                        to people about
                        water conservation in hopes for them to motivate them to save water.
                        Join us in our
                        campaign and pledge with us to save water!
                    </p>

                    <div class="mt-4">
                        <iframe width="100%" height="400" src="https://www.youtube.com/embed/BI2Q7X4kYxU"
                            frameborder="0"
                            allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen></iframe>
                    </div>
                </div>
                <div class="col-md-12 text-center mt-5">
                    <p style="font-size: 12px">Copyright &COPY; Save4TheFuture. Contact Us<a class="footer-link"
                            href="mailto:save4thefuture00@gmail.com">
                            <u>Here</u>.</a>
                        <br />R² &COPY; Rx and Rez.
                    </p>
                </div>
            </div>

        </div>
    </div>
</body>

<!-- Dependencies for Javascript Events -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>

<!-- Dependencies for Javascript Events -->
<script src="water-assets/scroll-overflow.min.js"></script>
<script src="water-assets/fullpage.js"></script>
<script src="https://cdn.jsdelivr.net/npm/countup@1.8.2/countUp.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>

<script>
    new fullpage('#fullpage', {
        autoScrolling: true,
        scrollHorizontally: true,
        navigation: true,
        navigationPosition: "right",
        scrollOverflow: true,
        loopBottom: true,
        fitToSection: false,
        sectionsColor: ['#51a7a8', '#FFFFFF', '#51a7a8', '#FFFFFF'],
    });

    appendLeadingZeroes = (n) => {
        if (n <= 9) {
            return "0" + n;
        }
        return n
    }

    incrementPledges = () => {
        countUp.update(pledgesCounter += 1);
        Swal.fire({
            icon: 'success',
            title: 'Pledged',
            text: 'Thanks for participating!',
            allowOutsideClick: false,
        }).then(() => Swal.close());
        postToJsonBin();
    }

    insertColumns = () => {
        let pledgeList = document.getElementById("pledges-list");
        const images = ["river.png", "waterfall.png", "mountains.png"];

        createColumn = (name, date) => {
            let index = [Math.floor(Math.random() * images.length)];

            return ("<div class='col-lg-4 col-md-12 col-sm-12 no-gutters justify-content-center pledge-card'><div class='media p-2'><img class='icon donor mr-4' src='water-assets/pledges-icons/" + images[index] + "' alt='icon' height='100'> <div class='media-body p-2 mb-0 border-bottom border-top border-gray w-100'><strong class='text-capitalize'>" + name + "</strong><span class='feed-datetime d-block text-muted small my-1'>" + date + "</span><span class='d-block medium mb-0'>Pledged to save water!</span></div></div></div>")
        };

        let top12Pledges = pledges.slice(-12).reverse()
        pledgeList.innerHTML = "";
        top12Pledges.map(pledge => (pledgeList.innerHTML += createColumn(pledge.name, pledge.date)));
    }

    // For Posting
    postToJsonBin = () => {
        let current_datetime = new Date()
        let formatted_date = current_datetime.getFullYear() + "-" + appendLeadingZeroes(current_datetime.getMonth() + 1) + "-" + appendLeadingZeroes(current_datetime.getDate()) + " " + appendLeadingZeroes(current_datetime.getHours()) + ":" + appendLeadingZeroes(current_datetime.getMinutes()) + ":" + appendLeadingZeroes(current_datetime.getSeconds())
        let pledgerName = document.getElementById("pledgerName").value;

        let req = new XMLHttpRequest();

        if (document.getElementById('pledgerName').value === "") {
            pledgerName = "Anonymous"
        }

        req.onreadystatechange = () => {
            if (req.readyState == XMLHttpRequest.DONE) {
                // Pass
            }
        };
        req.open("PUT", "https://api.jsonbin.io/b/5e1f46035df640720835ed12", false);
        req.setRequestHeader("Content-type", "application/json");
        pledges.push({ "name": pledgerName, "date": formatted_date })
        req.send(JSON.stringify(pledges));
        insertColumns();
    }

    let pledges = [];
    let pledgesCounter = 0;
    const countUp = new CountUp(counter, 0, 0, 0, 0.6);

    fetch("https://api.jsonbin.io/b/5e1f46035df640720835ed12/latest")
        .then(res => res.json())
        .then(data => pledges = data)
        .then(() => insertColumns())
        .then(() => $('#landing-loading').hide())
        .then(() => pledgesCounter = pledges.length)
        .then(() => startCount())
        .catch((err) => console.log(err));


    startCount = () => {
        const counter = document.querySelector('#counter');
        const countUp = new CountUp(counter, 0, pledgesCounter, 0, 0.6);
        if (!countUp.error) {
            countUp.start()
        } else {
            console.error(countUp.error)
        }
    }


</script>

</html>